<?xml version="1.0"?>
<Devices>

    <Device type="custom" id="EcobeeAccount">
        <Name>Ecobee User Account</Name>
        <ConfigUI>
            <Field id="getPin" type="button">
                <Label>1. Get an Ecobee PIN:</Label>
                <Title>Get PIN</Title>
                <CallbackMethod>request_pin</CallbackMethod>
            </Field>
 
            <Field id="pin" type="textfield" readonly="true">
                <Label>PIN:</Label>
            </Field>
 
            <Field id="openEcobee" type="button">
                <Label>2. Register the PIN:</Label>
                <Title>Open http://www.ecobee.com</Title>
                <CallbackMethod>open_browser_to_ecobee</CallbackMethod>
            </Field>
 
            <Field id="getTokens" type="button">
                <Label>3. Authenticate:</Label>
                <Title> GO </Title>
                <CallbackMethod>get_tokens</CallbackMethod>
            </Field>

            <Field id="separator2" type="separator"/>
 
            <Field id="authStatus" type="textfield" readonly="true">
                <Label>Authentication Status:</Label>
            </Field>
        </ConfigUI>
 
        <States>
            <State id="authenticated" readonly="true">
                <ValueType boolType="YesNo">Boolean</ValueType>
                <TriggerLabel>Authenticated</TriggerLabel>
                <ControlPageLabel>Authenticated</ControlPageLabel>
            </State>
        </States>
    </Device>
 
    <Device type="thermostat" id="EcobeeThermostat">
        <Name>Ecobee 3 , 3 lite, 4</Name>
        <ConfigUI>
            <Field id="account" type="menu">
                <Label>Ecobee Account:</Label>
                <List class="self" method="get_account_list" dynamicReload="true"/>
                <CallbackMethod>menuChanged</CallbackMethod>
            </Field>
            <Field id="address" type="menu">
                <Label>Thermostat:</Label>
                <List class="self" method="get_thermostat_list" dynamicReload="true"/>
                <CallbackMethod>menuChanged</CallbackMethod>
            </Field>
        </ConfigUI>
        <States>
            <State id="climate">
                <ValueType>String</ValueType>
                <TriggerLabel>Climate</TriggerLabel>
                <ControlPageLabel>Climate</ControlPageLabel>
            </State>
            <State id="occupied" readonly="true">
                <ValueType boolType="YesNo">Boolean</ValueType>
                <TriggerLabel>Occupied</TriggerLabel>
                <ControlPageLabel>Occupied</ControlPageLabel>
            </State>
            <State id="autoAway" readonly="true">
                <ValueType boolType="YesNo">Boolean</ValueType>
                <TriggerLabel>Auto-Away</TriggerLabel>
                <ControlPageLabel>Auto-Away</ControlPageLabel>
            </State>
            <State id="autoHome" readonly="true">
                <ValueType boolType="YesNo">Boolean</ValueType>
                <TriggerLabel>Auto-Home</TriggerLabel>
                <ControlPageLabel>Auto-Home</ControlPageLabel>
            </State>
            <State id="fanMinOnTime" readonly="false">
                <ValueType>Integer</ValueType>
                <TriggerLabel>Minimum fan time</TriggerLabel>
                <ControlPageLabel>Minimum fan time</ControlPageLabel>
            </State>
        </States>
    </Device>

    <Device type="thermostat" id="EcobeeSmartThermostat">
        <Name>Ecobee 'Smart', 'Smart Si'</Name>
        <ConfigUI>
            <Field id="account" type="menu">
                <Label>Ecobee Account:</Label>
                <List class="self" method="get_account_list" dynamicReload="true"/>
                <CallbackMethod>menuChanged</CallbackMethod>
            </Field>
            <Field id="address" type="menu">
                <Label>Thermostat:</Label>
                <List class="self" method="get_thermostat_list" dynamicReload="true"/>
                <CallbackMethod>menuChanged</CallbackMethod>
            </Field>
        </ConfigUI>
        <States>
            <State id="climate">
                <ValueType>String</ValueType>
                <TriggerLabel>Climate</TriggerLabel>
                <ControlPageLabel>Climate</ControlPageLabel>
            </State>
        </States>
    </Device>

    <Device type="sensor" id="EcobeeRemoteSensor">
        <Name>Ecobee Remote Sensor</Name>
        <ConfigUI>
			<Field id="SupportsOnState" type="checkbox" defaultValue="true" hidden="true" />
			<Field id="SupportsSensorValue" type="checkbox" defaultValue="true" hidden="true" />
			<Field id="SupportsStatusRequest" type="checkbox" defaultValue="true" hidden="true" />
            <Field id="account" type="menu">
                <Label>Ecobee Account:</Label>
                <List class="self" method="get_account_list" dynamicReload="true"/>
                <CallbackMethod>menuChanged</CallbackMethod>
            </Field>
            <Field id="address" type="menu">
                <Label>Thermostat:</Label>
                <List class="self" method="get_remote_sensor_list" dynamicReload="true"/>
                <CallbackMethod>menuChanged</CallbackMethod>
            </Field>
        </ConfigUI>
        <States>
            <State id="occupied" readonly="true">
                <ValueType boolType="YesNo">Boolean</ValueType>
                <TriggerLabel>Occupied</TriggerLabel>
                <ControlPageLabel>Occupied</ControlPageLabel>
            </State>
        </States>
        <UiDisplayStateId>temperature</UiDisplayStateId>
    </Device>
</Devices>
